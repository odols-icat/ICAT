*----------------------------------------------------------------------*
***INCLUDE LZRM_VALORACIO_OFERTESI10.
*----------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_1006  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE user_command_1006 INPUT.

  IF gr_util_dm_mat_co2 IS BOUND.
    gr_util_dm_mat_co2->user_command( sy-ucomm ).
  ENDIF.
ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  EXIT_COMMAND_1006  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE exit_command_1006 INPUT.
  DATA: lv_answer TYPE c.
*"Es comprova si s'han relitzat canvis abans de sortir
  IF gr_util_dm_mat_co2->get_flag_changes( ) = abap_on.
    CLEAR: lv_answer.
    CALL FUNCTION 'POPUP_TO_CONFIRM'
      EXPORTING
        titlebar              = text-i01
        text_question         = text-i02
        display_cancel_button = abap_off
      IMPORTING
        answer                = lv_answer.
    CHECK lv_answer = 1.
  ENDIF.

*  gr_util_dm_mat_co2->gv_exit_no_changes = abap_on.
  ">> PSPEC-1482, Inici Modificació - EVCHA
  IF g_docclass	= 'ZQDC'.
    LEAVE PROGRAM.
  ELSE.
    ">> PSPEC-1482, Fi Modificació - EVCHA
    CALL METHOD cl_gui_cfw=>flush.
    LEAVE TO LIST-PROCESSING AND RETURN TO SCREEN 0.
  ENDIF.
ENDMODULE.